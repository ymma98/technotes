# step-6, 自适应网格

## 步骤

- 在当前网格上求解PDE；
- 使用某些标准估算每个单元的误差；
- 标记那些误差较大的单元进行细化，标记那些误差较小的单元进行粗化，其他单元保持不变；
- 对标记的单元进行细化和粗化，以获得新的网格；
- 重复上述步骤，直到新网格上的误差足够小。


如果我们使用三角形网格（deal.II并不使用三角形网格），那么有两种基本的可能性：

- 最长边细化：在这种策略中，作为细化目标的三角形会通过从最长边的中点引入一条新边到对角顶点来进行细化。当然，最长边的中点必须通过某种方式平衡——还需要细化该边另一侧的单元（如果有的话）。如果相关边也是相邻单元的最长边，那么我们只需通过相邻单元的对角顶点再次生成一条新边；否则，需要稍微复杂的构造，这需要在邻居单元的至少一个其他边上增加新顶点，然后可能会传播到邻居的邻居，直到算法终止。这个过程很难用语言描述，而且因为deal.II不使用三角形网格，所以也不值得深入。若你有兴趣，可以随时观看介绍视频讲座15的内容，视频链接在本介绍的顶部。
- 红绿细化：另一种选择是所谓的“红-绿细化”。这种策略更加难以描述（但也在视频讲座中讨论过），其优势在于细化不会传播到目标单元的邻接单元之外。

这些方法在细化方式上有不同的变体，但它们的共同点是都生成了一个网格，在这个网格中，两个单元的边界是相邻单元的整条边。只要稍微进行一些工作，这种策略也很容易扩展到三维四面体网格中。

在二维网格中，不使用四边形单元的这些方法通常并不适用（或者至少不容易使用）。原因在于，四边形单元邻接单元的过渡元素（即它们的邻居）通常是三角形网格，而这些三角形网格和deal.II中的四边形网格并不匹配。我们通常使用网格，其中相邻单元的形状可以有所不同。这个问题更常见的是四边形单元的“悬挂节点”问题，这种方法会导致相邻单元的接口处出现不平衡的网格。


$$
-\nabla \cdot a(\mathbf{x}) \nabla u(\mathbf{x}) = 1 \quad \text{in } \Omega,
$$

$$
u = 0 \quad \text{on } \partial \Omega.
$$

$$
a(\mathbf{x}) =
\begin{cases}
20 & \text{if } |\mathbf{x}| < 0.5, \\
1 & \text{otherwise.}
\end{cases}
$$



<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE2MTI2NTAwMDgsLTE0NjkyOTEzMTldfQ
==
-->