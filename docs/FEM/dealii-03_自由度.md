# dealii-03: 自由度

有限元方法基于通过“分段”多项式近似微分方程的解 \( u \)，例如通过函数 \( u_h \) 来逼近方程 \(-\Delta u=f\) 的解。也就是说，我们将定义方程的区域 \( \Omega \) 划分为小的单元（在文档中我们通常用符号 \( K \) 表示）。在每个单元 \( K \) 上，我们寻找的近似函数 \( u_h \) 是一个多项式。（更严格地说，它是从“参考单元”映射过来的多项式的像，但我们暂时不需要让事情变得更复杂。）

在之前的教程程序（step-1 中），我们展示了如何将区域划分为单元并视作由 `Triangulation` 类表示的“网格”，以及如何在代码中实现这一点。在当前的教程程序中，我们展示了如何通过定义在这个网格上的自由度（degrees of freedom）的概念来表示分段多项式函数。对于这个例子，我们使用最低阶的有限元 \( Q_1 \)，即我们寻找的近似函数 \( u_h \) 在网格的每个四边形单元 \( K \) 上是“双线性”的。（如果我们使用三角形单元，那么它将是线性的。）

实际上，我们将函数表示为形函数 \( \varphi_j(x) \) 的线性组合，其中的系数 \( U_j \) 称为“自由度”。对于我们这里考虑的双线性函数，每个形函数和自由度都与网格的一个顶点相关联。后面的例子将展示高阶元素，在这些情况下，自由度不一定与顶点相关，而可能与边、面或单元相关联。

“自由度”这个术语在有限元社区中通常表示两个稍微不同但相关的概念。第一个是我们希望将有限元解表示为形函数的线性组合，形式为 \( u_h(x) = \sum_{j=0}^{N-1} U_j \varphi_j(x) \)。这里，\( U_j \) 是展开系数的向量。由于我们还不知道它们的值（我们将通过求解线性或非线性系统来计算它们），所以它们被称为“未知数”或“自由度”。第二个含义可以解释如下：有限元问题的数学描述通常是说我们在寻找一个有限维函数 \( u_h \in V_h \)，它满足某些方程组（例如 \( a(u_h, \varphi_h) = (f, \varphi_h) \) 对于所有测试函数 \( \varphi_h \in V_h \)）。换句话说，这里我们只是说解需要位于某个空间 \( V_h \) 中。然而，实际在计算机上求解这个问题时，我们需要选择该空间的一个基；这就是我们在上面用系数 \( U_j \) 表示 \( u_h(x) \) 时使用的形函数 \( \varphi_j(x) \)。当然，空间 \( V_h \) 有很多种基，但我们会选择由传统上定义在网格单元局部的有限元函数所描述的那个基。

### 自由度的枚举

在这个上下文中描述“自由度”意味着我们需要简单地枚举空间 \( V_h \) 的基函数。对于 \( Q_1 \) 元素，这意味着简单地以某种方式枚举网格的顶点，但对于高阶元素，还需要枚举与网格的边、面或单元内部相关联的形函数。换句话说，自由度的枚举与我们用于顶点的索引是完全独立的。提供 \( V_h \) 基函数枚举的类称为 `DoFHandler`。

在网格上定义自由度（简称“DoF”）在实际操作中是一个相当简单的任务，因为库会为你完成所有工作。基本上，你所需要做的只是创建一个有限元对象（从 deal.II 已经有的众多有限元类之一，例如参见[有限元空间描述文档](https://dealii.org/)）并将其传递给 `DoFHandler` 对象，通过 `DoFHandler::distribute_dofs()` 函数来完成（“分配自由度”是我们用于描述上述枚举基函数过程的术语）。`DoFHandler` 是一个类，它知道自由度的位置，即它可以回答诸如“全局有多少个自由度”和“在这个单元上，给我生活在这里的形函数的全局索引”等问题。这类信息在确定系统矩阵的大小以及将单个单元的贡献复制到全局矩阵时是必要的。

因此，当前程序的第一个任务是获取一个网格和一个有限元，并枚举自由度。在当前的上下文中，这意味着简单地为网格的每个顶点分配一个自由度索引。完成后，我们将输出一张图片，显示每个顶点与哪个自由度索引相关联。你可以在本教程的结果部分找到对应的图片。

值得指出的是，自由度在几何上位于何处并不是我们通常在有限元代码中关心的问题。大多数情况下，我们只关心自由度的枚举，而不关心哪个自由度在哪个位置。（我们还将在下面讨论自由度的重新编号时回到这个问题。）与此同时，看到这一点可能也是有意义的，因此这个程序展示了这样的图。
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTI3NzczMTldfQ==
-->