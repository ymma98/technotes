# dealii-03: 自由度


## step-2

在当前的教程程序中，我们展示了如何通过定义在该网格上的自由度（degrees of freedom，简称 DoF）的概念来表示分段多项式函数。在本例中，我们将使用最低阶的有限元 $Q_1$，即我们寻找的逼近函数 $u_h$ 在网格的每个四边形单元 $K$ 上是[“双线性”](https://defelement.com/elements/examples/quadrilateral-lagrange-equispaced-1.html)的。（如果我们使用三角形单元，则 $u_h$ 是线性的。）


在实践中，我们将函数表示为形函数 $\phi_j(x)$ 的线性组合，其中的系数 $U_j$ 称为“自由度”（degrees of freedom）。对于我们在这里考虑的双线性函数，每个形函数和自由度都与网格的一个顶点相关联。后续的例子将展示高阶单元，在这些单元中，自由度不一定与顶点相关联，还可能与网格的边、面或单元内部相关联。

“自由度”一词在有限元领域通常用于表示两个略有不同但相关的概念。第一个是，我们希望将有限元解表示为形函数的线性组合，形式为

$$
u_h(x) = \sum_{j=0}^{N-1} U_j \phi_j(x)
$$

这里，$U_j$ 是展开系数向量。由于我们尚不知道它们的值（我们将通过求解线性或非线性系统来得到它们），因此它们被称为“未知数”或“自由度”。该词的第二个含义如下：有限元问题的数学描述通常是寻找一个有限维函数 $u_h \in V_h$，使其满足某些方程组（例如，$a(u_h, \phi_h) = (f, \phi_h)$，对于所有测试函数 $\phi_h \in V_h$）。换句话说，这里我们只说明了解必须属于某个空间 $V_h$。然而，为了在计算机上实际求解该问题，我们需要选择该空间的一个基；这就是我们在上面使用形函数 $\phi_j(x)$ 和系数 $U_j$ 来展开 $u_h(x)$ 的原因。


* 自由度的枚举

在这种情况下，描述“自由度”需要我们简单地枚举 $V_h$ 空间的基函数。对于 $Q_1$ 元素，这意味着简单地枚举网格的顶点，但对于高阶元素，还需要枚举与网格的边、面或单元内部相关的形函数。换句话说，自由度的枚举与顶点的索引完全是两个独立的概念。**提供 $V_h$ 空间基函数枚举的类称为 `DoFHandler`。**

在网格上定义自由度（简称为 DoF）在实践中是一个相当简单的任务，因为库为你完成了所有工作。基本上，你所要做的就是创建一个有限元对象（来自 `deal.II` 已经拥有的许多有限元类之一，参见[有限元空间描述文档](https://www.dealii.org/current/doxygen/deal.II/group__fe.html)），并将其通过 `DoFHandler::distribute_dofs()` 函数传递给 `DoFHandler` 对象（“分配 DoFs”是我们用来描述上述枚举基函数过程的术语）。`DoFHandler` 是一个知道哪些自由度在哪里的类，即它可以回答诸如“全局有多少自由度”和“在这个单元上，给我这里存在的形函数的全局索引”之类的问题。**这是你在确定系统矩阵的大小以及将单个单元的贡献复制到全局矩阵时所需要的信息。**

因此，当前程序的第一个任务是获取一个网格和一个有限元，并枚举自由度。在当前的上下文中，这意味着简单地为网格的每个顶点分配一个自由度索引。完成此操作后，我们将在图中输出哪个顶点对应哪个自由度索引。

值得指出的是，几何上每个自由度的位置并不是我们在有限元代码中通常会问的问题。大多数时候，我们只关心所有自由度的枚举顺序，而不关心哪个自由度位于哪里。（

* 稀疏性

有限元矩阵通常是非常稀疏的：这些矩阵中的绝大多数元素都是零。

更确切地说，**我们说一个矩阵是稀疏的，如果矩阵中每行的非零元素数量被限制在一个与自由度总数无关的数值**。例如，拉普拉斯方程的有限差分逼近的简单 5 点模板会生成一个稀疏矩阵，因为每行的非零元素数量是五个，并且与矩阵的总大小无关。对于更复杂的问题——例如 step-22 中的斯托克斯问题，特别是在 3D 中，每行的非零元素可能达到几百个。但重要的是，这个数值与问题的整体大小无关：如果你细化网格，每行的最大未知数数量保持不变。

稀疏性是有限元方法与使用泰勒展开式逼近偏微分方程的解并匹配系数，或者使用傅里叶基逼近的一个显著区别。


<!--stackedit_data:
eyJoaXN0b3J5IjpbMTE3OTU5ODk3NiwxNzkxMDYzNzIzXX0=
-->