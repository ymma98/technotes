# step-7, Helmholtz方程与NeumannBC

## 方程

 `VectorTools::integrate_difference()` 该函数计算给定连续函数与有限元在每个单元上的不同范数。当然，像任何其他积分一样，我们只能使用求积公式来评估这些范数；因此，选择合适的求积公式对于准确评估误差至关重要。特别是对于 $L_{\infty}$ 范数，我们仅在求积点上评估数值解和精确解的最大偏差。事实上，这通常也是对其他范数的良好建议：如果你的求积点恰巧选在误差较小的位置，由于超收敛，计算出的误差看起来比实际小得多，甚至可能会建议更高的收敛阶次。因此，我们将为这些误差范数的积分选择不同于线性系统组装的求积公式。

函数 `VectorTools::integrate_difference()` 在三角剖分的每个单元 $K$ 上评估所需的范数，并返回一个包含每个单元这些值的向量。通过这些局部值，我们可以获得全局误差。例如，如果向量 \( e \) 包含所有单元 \( K \) 的元素 \( e_K \)，并包含局部 \( L_2 \) 范数 \( \|u - u_h\|_K \)，那么

$$
E = \left( \sum_K e_K^2 \right)^{1/2}
$$
就是全局的 \( L_2 \) 误差 \( E = \|u - u_h\|_{\Omega} \)。

<!--stackedit_data:
eyJoaXN0b3J5IjpbMTEwMDY5OTYyMSwxNzU0NjE2NjkzXX0=
-->