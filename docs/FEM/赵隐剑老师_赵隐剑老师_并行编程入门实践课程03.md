# 赵隐剑老师_并行编程入门实践课程 03

* 该笔记对应以下 b 站视频，主要讲在粒子-粒子方法中应用 openmp + mpi
	*  [并行编程入门与实践5](https://www.bilibili.com/video/BV1xHz7YFEMy/?spm_id_from=333.1387.homepage.video_card.click&vd_source=b7bbd99721bfe117cc47d14c9f45af86)


[TOC]

___

## 粒子-粒子方法


* 库仑定律 (Coulomb's Law)

$$
\vec{F}_{12} = \frac{1}{4 \pi \epsilon_0} \frac{q_1 q_2}{|\vec{r}_{12}|^2} \hat{r}_{12}
$$

其中：
$$
\vec{r}_{12} = \vec{r}_1 - \vec{r}_2, \quad \hat{r}_{12} = \frac{\vec{r}_{12}}{|\vec{r}_{12}|}
$$

$$
\vec{r}_1 = (x_1, y_1, z_1), \quad \vec{r}_2 = (x_2, y_2, z_2)
$$


* 电场与力的关系

$$
F = \vec{E} q \quad \Rightarrow \quad \vec{E}_{12} = \frac{1}{4 \pi \epsilon_0} \frac{q_2}{|\vec{r}_{12}|^2} \hat{r}_{12}
$$



* 多粒子系统 (Many Particles)

对于粒子 $j$ 对粒子$i$的作用：
$$
\vec{E}_{ij} = \frac{1}{4 \pi \epsilon_0} \frac{q_j}{|\vec{r}_{ij}|^2} \hat{r}_{ij}
$$

总场为：
$$
\vec{E}_i = \sum_{\substack{j=1 \\ j \neq i}}^N \vec{E}_{ij} = \frac{1}{4 \pi \epsilon_0} \sum_{\substack{j=1 \\ j \neq i}}^N \frac{q_j}{|\vec{r}_{ij}|^2} \hat{r}_{ij}
$$

*  宏粒子

对于一个模拟粒子系统，假定体积 $V$，粒子密度为$n$

设权重：

$$
w = \frac{nV}{N}
$$

则：
$$
\vec{E}_i = \frac{1}{4 \pi \epsilon_0} \sum_{\substack{j=1 \\ j \neq i}}^N \frac{w q_j}{|\vec{r}_{ij}|^2} \hat{r}_{ij}
$$



令 $q_j = q$，并定义：
$$
k_e = \frac{w q}{4 \pi \epsilon_0}
$$

因此：
$$
\vec{E}_i = k_e \sum_{\substack{j=1 \\ j \neq i}}^N \frac{\hat{r}_{ij}}{|\vec{r}_{ij}|^2}
$$



伪代码如下：

do $i = 1, N$  
&emsp; do $j = 1, N$  
&emsp;&emsp; 更新电场：$\vec{E}_i \;=\; \vec{E}_i \;+\; k_e \,\dfrac{\hat{r}_{ij}}{\lvert\vec{r}_{ij}\rvert^2}$  
&emsp; end do  
end do



<!--stackedit_data:
eyJoaXN0b3J5IjpbNTUzNDQxNjM2LC0xODAyNjY5ODkzXX0=
-->